# 무상태 프로토콜

산드로라는 사용자가 서버에 10번 요청을 보내도  서버는 그 10번의 요청이 산드로 사람이 보낸 것인지 모른다. 상태를 갖고있지 않기 때문이다. 

하지만 서버는 요청마다 누가 보낸 요청인지 식별해야 할 필요도 있다. 가장 쉬운 방법으로 쿼리 파라미터에 정보를 담아서 전달할 수 있다. 대표적으로 **쿠키**를 사용한다.

# 쿠키

쿠키는 HTTP 요청을 식별하는 데 필요한 정보이다. 쉽게 말하면 HTTP 요청에 이름표를 붙이는 것이다. 

쿠키를 사용한 로그인 과정을 예로든다. 사용자는 로그인을 하기위해 서버에 id,pw를 보낸다. 서버는  전달 받은 id,pw가 확인되면 **쿠키**를 생성해서 사용자에게 전달한다. 쿠키에는 이름표처럼 사용자를 식별할 수 있는 정보가 담겨있다. 

사용자에게 전달된 쿠키는 브라우저에 있는 쿠키저장소에 저장되고 사용자가 요청을 보낼 때마다 요청에 실려서 서버로 전달된다. 이제 서버는 요청에 담긴 쿠키를 보고 요청을 식별할 수 있다.

쿠키는 사용자가 쿠키의 정보를 변경하기 쉽고 요청마다 쿠키를 날리기 때문에 탈취당할 가능성도 크다. 그래서 보통 쿠키에는 중요한 데이터를 담지 않는다. 

### 정리

- 쿠키는 유저의 브라우저에 저장되어 있고 유저가 요청을 보낼 때마다 함께 서버로 전달된다.
- 쿠키는 내용 수정이 쉽고 외부로 노출될 가능성이 높다.

# 세션

쿠키의 단점을 보완하기 위해서 세션을 사용한다. 

세션을 사용하는 로그인과정을 살펴보자. 서버는 사용자가 보낸 id,pw가 정상적으로 확인되면 **복잡한 암호를 생성**해서 사용자의 정보와 함께 **세션 저장소**에 저장한다. 그리고 사용자에게 쿠키로 생성한 암호를 전달한다. 사용자가 요청을 보낼 때마다 서버는 요청에 담긴 쿠키 속 암호가 세션 저장소에 있는지 확인하는 식으로 사용자를 식별한다. 

쿠키에 담긴 암호는 암호 자체로는 아무 의미 없는 데이터다. 복잡한 암호를 수정해도 다른 사용자의 데이터에 접근할 가능성은 매우 적다. 그리고 쿠키가 외부로 노출되서 다른 사람이 쿠키를 사용해도 서버에서 통제할 수 있다. 세션저장소에 담긴 데이터를 지우기만 하면 쿠키가 무효화 된다. 
